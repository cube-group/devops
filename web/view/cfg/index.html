{{define "cfg/index.html"}}
    {{template "layout/top.html" .}}
    <div class="panel">
        <div class="panel-heading">
            <div class="panel-title">
                系统配置-镜像仓库配置
            </div>
            <div class="right">
                <button type="button" class="btn-toggle-collapse"><i class="lnr lnr-chevron-up"></i>
                </button>
            </div>
        </div>
        <div class="panel-body" style="padding-left: 40px;">
            <div class="form-group">
                <label>仓库域<span style="color: #FF1717">*</span></label>
                <input type="text" class="form-control" v-model="cfg.registryHost" placeholder="registry.xx.com">
            </div>
            <div class="form-group">
                <label>账户</label>
                <input type="text" class="form-control" v-model="cfg.registryUsername" placeholder="账号">
            </div>
            <div class="form-group">
                <label>密码</label>
                <input type="password" class="form-control" v-model="cfg.registryPassword" placeholder="密码">
            </div>
            <div class="form-group">
                <label>命名空间</label>
                <input type="text" class="form-control" v-model="cfg.registryNamespace" placeholder="如：test">
            </div>
        </div>
    </div>
    <!-- ci镜像 -->
    <div class="panel">
        <div class="panel-heading">
            <div class="panel-title">
                基础ci镜像列表
            </div>
            <div class="right">
                <button type="button" class="btn-toggle-collapse"><i class="lnr lnr-chevron-up"></i>
                </button>
            </div>
        </div>
        <div class="panel-body" style="padding-left: 40px;">
            <label>image about ssh.</label>
            <div class="form-group">
                <div class="input-group">
                    <div class="input-group-addon">image SSH</div>
                    <input class="form-control" placeholder="cubegroup/devops-ssh" v-model="cfg.imageSsh">
                </div>
            </div>
            <label>image list about ci.</label>
            <div class="form-group" v-for="(v,i) in cfg.ci">
                <div class="input-group">
                    <div class="input-group-addon">name</div>
                    <input class="form-control" placeholder="[A-Za-z0-9]*" v-model="v.key">
                    <div class="input-group-addon">name</div>
                    <input class="form-control" placeholder="image address" v-model="v.value">
                    <div class="input-group-btn">
                        <a class="btn btn-success" @click="cfg.ci.push({})">添加</a>
                    </div>
                    <div class="input-group-btn">
                        <a class="btn btn-danger" @click="cfg.ci.splice(i,1)">移除</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="panel">
        <div class="panel-heading">
            <div class="panel-title">
                系统部署阻断
            </div>
            <div class="right">
                <button type="button" class="btn-toggle-collapse"><i class="lnr lnr-chevron-up"></i>
                </button>
            </div>
        </div>
        <div class="panel-body" style="padding-left: 40px;">
            <div class="form-group">
                <label>阻断内容</label>
                <input type="text" class="form-control" v-model="cfg.onlineBlock" placeholder="为空则不阻断项目部署">
            </div>
        </div>
    </div>
    <div class="form-group">
        <a class="btn btn-primary" @click="onSave()">保存</a>
    </div>

    <script>
        var cfg = {{.cfg}};
        if (!cfg) {
            cfg = {};
        }
        objectArrayInitForRender(cfg, "ci", {});
    </script>
    <!-- vue -->
    <script>
        vueMixin = {
            data: {
                cfg: cfg,
            },
            methods: {
                onSave() {
                    displayConfirm('确认保存?', '确认', '取消', () => {
                        var requestURL = baseURL('/cfg');
                        var data = deepCloneObject(this.cfg);
                        reqPostJson(requestURL, data, baseURL('/cfg'));
                    });
                },
            },
            created() {
            },
        };
    </script>

    {{template "layout/footer.html" . }}
{{end}}